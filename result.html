<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>診断結果</title>
<style>
  body { font-family: sans-serif; max-width: 800px; margin: auto; padding: 20px; }
  h1 { text-align: center; }

  #result {
    text-align: center;
    margin-top: 40px;
  }
  .rank-block {
    margin: 30px 0;
  }
  .score {
    font-size: 18px;
    color: #555;
  }

  .match-bar {
  width: 80%;
  height: 14px;
  background: #eee;
  border-radius: 7px;
  margin: 10px auto;
  overflow: hidden;
}

.match-bar-fill {
  height: 100%;
  background: #36a0d9; /* 緑（MBTI風） */
  transition: width 0.6s ease;
}
</style>
</head>
<body>

<h1>診断結果</h1>
<div id="result"></div>

<script>
// ユーザー回答
const user = JSON.parse(localStorage.getItem("userAnswers"));


// キャラの14軸データ
const characters = {
  "氷鷹北斗(ひだか ほくと)": [1,3,2,4,2,2,3,2,2,1,4,4,1,1],
  "明星スバル（あけほし すばる）": [1,1,3,5,1,5,4,2,2,2,3,3,1,1],
  "遊木真（ゆうき まこと）": [1,5,2,2,2,3,3,2,5,2,3,4,2,1],
  "衣更真緒（いさら まお）": [1,5,1,1,2,3,4,2,5,2,3,4,2,1],
  "天祥院英智（てんしょういん えいち）": [4,1,2,5,3,2,1,1,2,1,3,5,4,2],
  "日々樹渉（ひびき わたる）": [4,1,2,5,2,5,1,4,1,1,2,3,5,4],
  "姫宮桃李（ひめみや とうり）": [2,4,5,5,2,4,3,4,4,5,1,2,1,1],
  "伏見弓弦（ふしみ ゆづる）": [2,4,1,1,2,1,3,1,4,1,4,5,4,2],
  "南雲鉄虎（なぐも てとら）": [1,5,3,4,1,4,5,2,5,2,4,3,1,1],
  "高峯翠（たかみね みどり）": [2,5,4,2,5,1,4,4,5,1,4,1,4,1],
  "守沢千秋（もりさわ ちあき）": [1,5,1,4,1,5,5,1,5,1,5,5,2,1],
  "深海奏汰（しんかい かなた）": [3,1,3,5,2,1,1,1,1,2,3,5,4,4],
  "仙石忍（せんごく しのぶ）": [1,4,4,5,1,5,4,3,4,5,2,3,1,1],
  "天城一彩（あまぎ ひいろ）": [1,4,3,1,1,5,5,1,2,2,4,2,1,1],
  "白鳥藍良（しらとり あいら）": [1,5,4,4,2,4,2,4,5,4,1,2,1,1],
  "礼瀬マヨイ（あやせ まよい）": [5,1,1,2,1,1,1,5,1,1,1,3,5,5],
  "風早巽（かぜはや たつみ）": [2,2,1,1,1,1,3,1,4,1,4,5,2,1],
  "乱凪砂（らん なぎさ）": [4,1,4,4,1,1,1,1,2,1,5,4,1,5],
  "巴日和（ともえ ひより）": [4,1,5,4,1,5,1,4,1,1,2,3,2,4],
  "七種茨（さえぐさ いばら）": [5,5,1,1,4,4,4,1,2,1,2,3,5,4],
  "漣ジュン（さざなみ じゅん）": [4,5,2,2,5,2,5,2,5,1,4,2,2,2],
  "斎宮宗（いつき しゅう）": [5,1,4,5,5,2,1,5,1,1,4,5,4,5],
  "影片みか（かげひら みか）": [4,4,4,5,1,2,1,4,4,2,3,1,1,3],
  "葵ひなた（あおい ひなた）": [2,3,4,4,1,5,4,3,5,4,2,2,2,1],
  "葵ゆうた（あおい ゆうた）": [2,3,2,2,2,5,4,3,5,4,2,2,3,1],
  "天城燐音（あまぎ りんね）": [5,2,1,5,4,5,4,2,1,1,5,5,4,4],
  "HiMERU（ひめる）": [3,1,2,1,5,1,2,2,1,1,2,2,5,5],
  "桜河こはく（おうかわ こはく）": [4,4,2,1,3,2,4,4,2,4,2,3,2,2],
  "椎名ニキ（しいな にき）": [2,1,2,1,1,4,4,1,5,1,2,3,1,2],
  "朔間零（さくま れい）": [5,1,1,3,2,1,1,1,2,1,2,4,4,5],
  "羽風薫（はかぜ かおる）": [4,4,2,2,2,4,4,1,5,1,4,2,2,2],
  "大神晃牙（おおがみ こうが）": [4,5,2,5,5,5,5,5,4,1,5,2,1,2],
  "乙狩アドニス（おとがり あどにす）": [2,4,1,1,1,1,5,1,1,1,5,3,1,2],
  "仁兎なずな（にと なずな）": [2,5,1,1,4,2,4,1,5,5,1,4,1,1],
  "紫之創（しの はじめ）": [2,5,3,4,1,1,2,2,5,5,1,3,1,1],
  "真白友也（ましろ ともや）": [2,5,2,2,1,2,4,2,5,4,3,3,2,1],
  "天満光（てんま みつる）": [1,1,4,5,1,5,4,2,1,5,4,3,1,1],
  "蓮巳敬人（はすみ けいと）": [1,5,1,1,4,2,4,1,4,1,4,4,3,1],
  "鬼龍紅郎（きりゅう くろう）": [2,4,1,2,2,2,5,1,4,1,5,3,2,2],
  "神崎颯馬（かんざき そうま）": [1,5,4,4,1,2,2,4,2,1,2,2,1,1],
  "月永レオ（つきなが れお）": [4,1,4,5,1,5,1,5,1,3,2,4,2,3],
  "瀬名泉（せな いずみ）": [4,2,1,4,5,2,1,5,1,1,3,2,1,4],
  "朔間凛月（さくま りつ）": [4,1,5,4,4,1,1,3,2,1,2,2,4,5],
  "鳴上嵐（なるかみ あらし）": [2,4,1,3,1,4,2,1,2,1,1,3,2,3],
  "朱桜司（すおう つかさ）": [1,5,4,5,1,4,4,4,2,2,3,2,2,1],
  "逆先夏目（さかさき なつめ）": [4,2,2,4,5,2,1,4,1,2,2,3,4,5],
  "青葉つむぎ（あおば つむぎ）": [2,4,1,2,1,2,2,1,4,1,3,3,2,1],
  "春川宙（はるかわ そら）": [1,1,5,5,1,5,1,4,1,5,2,3,2,1],
  "三毛縞斑（みけじま まだら）": [1,2,1,2,1,5,4,1,1,1,5,3,5,2]
};

// 距離計算
function distance(a, b) {
  return a.reduce((sum, val, i) => sum + Math.abs(val - b[i]), 0);
}

// 一致度（％）
function matchPercent(dist) {
  const maxDist = 14 * 4; // 56
  return Math.round((1 - dist / maxDist) * 100);
}

// 軸ごとのコメント
const axisComments = [
  ["正統派ヒーロー", "ダークなヴィラン"],
  ["天才肌", "努力家"],
  ["面倒見の良い", "甘えたり支えられがち"],
  ["現実的で堅実", "夢や理想を追う"],
  ["素直", "ツンデレ気質"],
  ["静かで穏やか", "賑やかで明るい"],
  ["芸術肌", "体育会系"],
  ["情緒が安定", "感情豊か"],
  ["クセが強い", "親しみやすい"],
  ["ショタはあんまり...", "ショタ大好き"],
  ["中性的", "男らしい"],
  ["依存する側", "依存される側"],
  ["内面を言語化する", "本音を隠す"],
  ["清廉で純粋", "妖艶でミステリアス"]
];

// コメント生成
function generateComment(user, charData) {
  let comments = [];
  for (let i = 0; i < 14; i++) {
    const diff = Math.abs(user[i] - charData[i]);
    if (diff <= 1) {
      const side = user[i] >= 3 ? 1 : 0;
      comments.push(axisComments[i][side]);
    }
  }

  if (comments.length > 0) {
    return "特に一致したのは…<br>・" + comments.slice(0, 3).join("<br>・");
  } else {
    return "このキャラとは全体的にバランスよく近い傾向があります。";
  }
}

// ランキング生成
let results = [];
for (const name in characters) {
  const d = distance(user, characters[name]);
  results.push({
    name: name,
    score: d,
    percent: matchPercent(d),   // ← 一致度を追加
    comment: generateComment(user, characters[name])
  });
}

results.sort((a, b) => a.score - b.score);

// HTML 出力
document.getElementById("result").innerHTML = `
  <div class="rank-block">
    <h2>1位：${results[0].name}</h2>
    <p class="score">一致度：${results[0].percent}%</p>
    <div class="match-bar">
      <div class="match-bar-fill" style="width:${results[0].percent}%;"></div>
    </div>
    <p>${results[0].comment}</p>
  </div>

  <div class="rank-block">
    <h3>2位：${results[1].name}</h3>
    <p class="score">一致度：${results[1].percent}%</p>
    <div class="match-bar">
      <div class="match-bar-fill" style="width:${results[1].percent}%;"></div>
    </div>
    <p>${results[1].comment}</p>
  </div>

  <div class="rank-block">
    <h3>3位：${results[2].name}</h3>
    <p class="score">一致度：${results[2].percent}%</p>
    <div class="match-bar">
      <div class="match-bar-fill" style="width:${results[2].percent}%;"></div>
    </div>
    <p>${results[2].comment}</p>
  </div>
`;

</script>

</body>
</html>